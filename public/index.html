<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrap Pet 🐱 - Developed by Sriram Rajagopalan</title>
    <meta name="description" content="Scrap Pet is a lightweight web scraping tool developed by Sriram Rajagopalan. Quickly fetch and analyze web page content with ease.">
    <meta name="author" content="Sriram Rajagopalan">
    <meta name="keywords" content="web scraping, Scrap Pet, Sriram Rajagopalan, web content scraper">
    <meta property="og:title" content="Scrap Pet 🐱 - Developed by Sriram Rajagopalan">
    <meta property="og:description" content="Scrap Pet is a web scraping tool that simplifies fetching web content.">
    <meta property="og:url" content="https://sriraj66.github.io">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Scrap Pet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="https://png.pngtree.com/png-vector/20190302/ourmid/pngtree-vector-vacuum-cleaner-icon-png-image_745619.jpg" type="image/x-icon">
</head>
<body>
    <h1 class="animate__animated animate__bounce">Scrap Pet 🐱</h1>
    <form id="scrapeForm" class="form-container animate__animated animate__zoomIn">
        <label for="url">Enter URL:</label>
        <input type="text" id="url" name="url" required placeholder="https://sriraj66.github.io">
        <button type="submit" id="submitBtn">
            <span id="spinner">.</span>
            Scrape
        </button>
    </form>
    <div id="result">
        <p>
            <b>Title:</b> <span id="title"></span> 
            <span id="s_code" class="s_code"></span> 
            <span id="meta-details"></span>
        </p>
        <textarea id="htmlContent" readonly></textarea>
        <button class="copy-btn" id="copyBtn">Copy to Clipboard</button>
    </div>
    <footer>
        <p>Developed by <strong>Sriram Rajagopalan</strong>. Visit my site: 
            <a href="https://sriraj66.github.io" target="_blank">sriraj66.github.io</a>
        </p>
    </footer>

    <script>
        const form = document.getElementById('scrapeForm');
        const resultDiv = document.getElementById('result');
        const spinner = document.getElementById('spinner');
        const submitBtn = document.getElementById('submitBtn');
        const titleElem = document.getElementById('title');
        const metaDetails = document.getElementById('meta-details');
        const htmlContent = document.getElementById('htmlContent');
        const copyBtn = document.getElementById('copyBtn');
        resultDiv.style.display = 'none';

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const url = document.getElementById('url').value;

            submitBtn.disabled = true;
            spinner.style.display = 'inline-block';
            resultDiv.style.display = 'none';

            try {
                const response = await fetch('/scrape', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });

                const data = await response.json();
                if (data.code === 200) {
                    titleElem.textContent = data.title;
                    htmlContent.textContent = data.html;
                    document.getElementById("s_code").innerText = `[ ${200} OK ]`;

                    // Add [ms, size] dynamically
                    const ms = data.ms || 'N/A';
                    const size = data.size || 'N/A';
                    metaDetails.innerText = `[ ${ms} ms, ${size} ]`;

                    resultDiv.style.display = 'block';
                } else {
                    alert("Failed to scrape content.");
                }
            } catch (err) {
                alert("An error occurred.");
                console.error(err);
            } finally {
                submitBtn.disabled = false;
                spinner.style.display = 'none';
            }
        });

        copyBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(htmlContent.value);
            alert("HTML content copied to clipboard!");
        });
    </script>
</body>
</html>
